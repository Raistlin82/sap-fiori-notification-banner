sap.ui.define(["sap/ui/base/Object","sap/base/Log"],function(t,e){"use strict";return t.extend("com.sap.notifications.banner2.controller.TileCounter",{constructor:function(){t.apply(this,arguments);this._updateInterval=null;this._updateFrequency=6e4;this._isRunning=false},start:function(){if(this._isRunning){return}this._isRunning=true;this._updateTile();var t=this;this._updateInterval=setInterval(function(){t._updateTile()},this._updateFrequency);e.info("TileCounter started - updating every "+this._updateFrequency/1e3+" seconds")},stop:function(){if(this._updateInterval){clearInterval(this._updateInterval);this._updateInterval=null}this._isRunning=false;e.info("TileCounter stopped")},_updateTile:function(){var t=this;jQuery.ajax({url:"/sap/bc/rest/zcl_notif_rest/stats",type:"GET",timeout:5e3,success:function(e){t._updateTileContent(e)},error:function(t,n,i){e.error("Failed to fetch notification stats for tile: "+i)}})},_updateTileContent:function(t){try{if(typeof sap==="undefined"||!sap.ushell||!sap.ushell.Container){e.warning("Not running in FLP context - tile update skipped");return}var n=this._getTileAPI();if(!n){e.warning("Could not access FLP tile API");return}var i=t.total||0;var r=t.high_count||0;var a=t.medium_count||0;var s=t.low_count||0;var o=this._formatBreakdown(r,a,s);var u=this._getInfoState(r);var l={number:i,numberUnit:"Active",info:o,infoState:u};n.setTitle("System Notifications");n.setNumber(l.number.toString());n.setNumberUnit(l.numberUnit);n.setInfo(l.info);n.setInfoState(l.infoState);e.info("Tile updated: "+i+" active notifications ("+o+")")}catch(t){e.error("Error updating tile content: "+t.message)}},_getTileAPI:function(){try{var t=sap.ui.getCore().getComponent(this.getOwnerComponent().getId()).getComponentData();if(t&&t.startupParameters&&t.startupParameters.tileAPI){return t.startupParameters.tileAPI[0]}if(sap.ushell&&sap.ushell.Container){var n=sap.ushell.Container.getRenderer("fiori2");if(n){return n.getDynamicPageTitle()}}return null}catch(t){e.error("Error accessing tile API: "+t.message);return null}},_formatBreakdown:function(t,e,n){if(t===0&&e===0&&n===0){return"No active notifications"}var i=[];if(t>0){i.push(t+"H")}if(e>0){i.push(e+"M")}if(n>0){i.push(n+"L")}return i.join("|")},_getInfoState:function(t){if(t>=3){return"Error"}else if(t>0){return"Warning"}else{return"Success"}},destroy:function(){this.stop();t.prototype.destroy.apply(this,arguments)}})});
//# sourceMappingURL=TileCounter.js.map